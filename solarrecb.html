<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏∞‡∏ö‡∏ö‡πÇ‡∏ã‡∏•‡∏≤‡∏£‡πå‡πÄ‡∏ã‡∏•‡∏•‡πå</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <style>
    .package-card { border-radius: 1rem; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
  </style>
</head>
<body class="bg-light">
  <div class="container py-5">
    <h1 class="text-center mb-4">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏∞‡∏ö‡∏ö‡∏ú‡∏•‡∏¥‡∏ï‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡πÅ‡∏™‡∏á‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå</h1>

    <!-- 1. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå -->
    <div class="mb-4">
      <label class="form-label fw-bold">1. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå:</label><br>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="meterType" id="tou" value="TOU" checked>
        <label class="form-check-label" for="tou">TOU</label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="meterType" id="tod" value="TOD">
        <label class="form-check-label" for="tod">TOD</label>
      </div>
    </div>

    <!-- 2. ‡∏™‡πÑ‡∏•‡∏î‡πå‡∏ö‡∏≤‡∏£‡πå ‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô/‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô -->
    <div class="mb-4">
      <label for="dayRatio" class="form-label fw-bold">2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô: <span id="dayRatioValue">50</span>%</label>
      <input type="range" class="form-range" min="0" max="100" value="50" id="dayRatio">
    </div>

    <!-- 3. ‡∏õ‡πâ‡∏≠‡∏ô‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü -->
    <div class="mb-4">
      <label for="monthlyCost" class="form-label fw-bold">3. ‡∏õ‡πâ‡∏≠‡∏ô‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (‡∏ö‡∏≤‡∏ó):</label>
      <input type="number" id="monthlyCost" class="form-control" placeholder="‡πÄ‡∏ä‡πà‡∏ô 3000">
    </div>

    <!-- 4. ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå -->
    <div class="mb-4">
      <button class="btn btn-primary" onclick="calculate()">4. ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</button>
    </div>

    <div id="result" class="mb-5"></div>

    <!-- 5. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Package -->
    <h4 class="fw-bold">5. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Package ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£:</h4>
    <div class="mb-3">
      <select class="form-select" id="packageSelect" onchange="displaySelectedPackage()">
        <option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Package --</option>
      </select>
    </div>
    <div id="selectedPackageDetail"></div>
  </div>

  <script>
    const packages = {
      Standard: [
        { size: 3, price: 90000, inverter: 'Strijng', type: 'String Inverter' },
        { size: 5, price: 120000, inverter: 'Strijng', type: 'String Inverter' },
        { size: 10, price: 200000, inverter: 'Strijng', type: 'String Inverter' }
      ],
      Gold: [
        { size: 3, price: 110000, inverter: 'Hoymiles', type: 'Micro Inverter' },
        { size: 5, price: 135000, inverter: 'Hoymiles', type: 'Micro Inverter' },
        { size: 10, price: 220000, inverter: 'Hoymiles', type: 'Micro Inverter' }
      ],
      Premium: [
        { size: 3, price: 130000, inverter: 'APSystems', type: 'Micro Inverter' },
        { size: 5, price: 155000, inverter: 'APSystems', type: 'Micro Inverter' },
        { size: 10, price: 250000, inverter: 'APSystems', type: 'Micro Inverter' }
      ]
    };

    let recommendedKw = 0;

    document.getElementById("dayRatio").addEventListener("input", e => {
      document.getElementById("dayRatioValue").textContent = e.target.value;
    });

  function calculate() {
  const monthlyCost = parseFloat(document.getElementById("monthlyCost").value);
  const dayRatio = parseInt(document.getElementById("dayRatio").value);
  const meterType = document.querySelector('input[name="meterType"]:checked').value;

  if (isNaN(monthlyCost) || monthlyCost <= 0) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏õ‡πâ‡∏≠‡∏ô‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á");

  let totalKwh;

  if (meterType === "TOD") {
    totalKwh = monthlyCost / 4.5; // ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ 4.5 ‡∏ö‡∏≤‡∏ó‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢
  } else if (meterType === "TOU") {
    // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏£‡∏ß‡∏°‡∏ï‡∏≤‡∏°‡πÄ‡∏ß‡∏•‡∏≤ Onpeak / Offpeak ‡πÅ‡∏•‡∏∞‡∏ß‡∏±‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤ / ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î
    const weekdayOnpeakHours = 13;   // 9.00 - 22.00
    const weekdayOffpeakHours = 11;  // ‡∏ô‡∏≠‡∏Å‡∏ä‡πà‡∏ß‡∏á Onpeak
    const weekendHours = 24;

    const weekdays = 5;
    const weekends = 2;

    const totalHours = (weekdays * 24) + (weekends * 24);
    const totalOnpeakHours = weekdays * weekdayOnpeakHours;
    const totalOffpeakHours = (weekdays * weekdayOffpeakHours) + (weekends * weekendHours);

    const avgPricePerUnit = ((totalOnpeakHours * 5.5) + (totalOffpeakHours * 2.5)) / totalHours;

    totalKwh = monthlyCost / avgPricePerUnit;
  }

  const dayKwh = totalKwh * (dayRatio / 100);
  recommendedKw = Math.ceil(dayKwh / (4 * 30)); // ‡∏™‡∏°‡∏°‡∏∏‡∏ï‡∏¥‡∏ú‡∏•‡∏¥‡∏ï‡πÑ‡∏î‡πâ 4 ‡∏´‡∏ô‡πà‡∏ß‡∏¢/‡∏ß‡∏±‡∏ô/kW

  const result = `
    <div class="alert alert-info">
      <p>‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ <strong>${totalKwh.toFixed(1)}</strong> ‡∏´‡∏ô‡πà‡∏ß‡∏¢/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</p>
      <p>‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô‡πÉ‡∏ä‡πâ <strong>${dayKwh.toFixed(1)}</strong> ‡∏´‡∏ô‡πà‡∏ß‡∏¢/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</p>
      <p>‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: ‡∏Ç‡∏ô‡∏≤‡∏î <strong>${recommendedKw} kW</strong></p>
    </div>
  `;
  document.getElementById("result").innerHTML = result;
  populatePackageDropdown();
}


function populatePackageDropdown() {
  const select = document.getElementById("packageSelect");
  select.innerHTML = '<option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Package --</option>';

  let hasMatchingPackage = false;

  for (const [type, list] of Object.entries(packages)) {
    list.forEach(pkg => {
      if (pkg.size >= recommendedKw) {
        hasMatchingPackage = true;
        const value = `${type}|${pkg.size}`;
        select.innerHTML += `<option value="${value}">${type} ${pkg.size} kW</option>`;
      }
    });
  }

  // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à‡∏ó‡∏µ‡πà >= recommendedKw ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÅ‡∏ó‡∏ô
  if (!hasMatchingPackage) {
    for (const [type, list] of Object.entries(packages)) {
      const maxPkg = list[list.length - 1]; // ‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡∏™‡∏∏‡∏î (‡∏≠‡∏¢‡∏π‡πà‡∏ó‡πâ‡∏≤‡∏¢ array)
      const value = `${type}|${maxPkg.size}`;
      select.innerHTML += `<option value="${value}">${type} ${maxPkg.size} kW</option>`;
    }

    // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
    document.getElementById("result").innerHTML += `
      <div class="alert alert-warning mt-3">
        ‡∏Ç‡∏ô‡∏≤‡∏î‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏Å‡∏¥‡∏ô‡∏Å‡∏ß‡πà‡∏≤‡∏Ç‡∏ô‡∏≤‡∏î‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à‡∏ó‡∏µ‡πà‡∏°‡∏µ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
      </div>
    `;
  }
}


    function displaySelectedPackage() {
      const selected = document.getElementById("packageSelect").value;
      const container = document.getElementById("selectedPackageDetail");
      if (!selected) return container.innerHTML = "";

      const [type, sizeStr] = selected.split("|");
      const size = parseInt(sizeStr);
      const pkg = packages[type].find(p => p.size === size);
      const price = pkg.price;
      const panelCount = size >= 10 ? 16 : size === 5 ? 8 : 5;
      const annualSaving = size * 4 * 30 * 4.5 * 12;
      const payback = (price / annualSaving).toFixed(1);

      const advantages = {
        Standard: '‡∏£‡∏≤‡∏Ñ‡∏≤‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ö‡πâ‡∏≤‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ ‡∏£‡∏∞‡∏ö‡∏ö‡∏á‡πà‡∏≤‡∏¢‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•',
        Gold: '‡∏°‡∏µ Micro Inverter ‡πÅ‡∏¢‡∏Å‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÅ‡∏ú‡∏á ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡πÉ‡∏ô‡∏Å‡∏£‡∏ì‡∏µ‡πÅ‡∏™‡∏á‡πÑ‡∏°‡πà‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠',
        Premium: '‡πÉ‡∏ä‡πâ Micro Inverter ‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏™‡∏π‡∏á ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÅ‡∏ú‡∏á‡∏≠‡∏¥‡∏™‡∏£‡∏∞ ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô'
      };

      container.innerHTML = `
        <div class="card package-card p-4">
          <h5>${type} ${size} kW</h5>
          <p><strong>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ú‡∏á:</strong> JA Solar ${panelCount} ‡πÅ‡∏ú‡∏á</p>
          <p><strong>‡∏£‡∏≤‡∏Ñ‡∏≤:</strong> ${price.toLocaleString()} ‡∏ö‡∏≤‡∏ó</p>
          <hr>
          <h6 class="mt-3">üîå ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î Inverter</h6>
          <p><strong>‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠:</strong> ${pkg.inverter}</p>
          <p><strong>‡∏ä‡∏ô‡∏¥‡∏î:</strong> ${pkg.type}</p>
          <hr>
          <p><strong>‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏Ñ‡∏∏‡πâ‡∏°‡∏ó‡∏∏‡∏ô‡πÇ‡∏î‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì:</strong> ${payback} ‡∏õ‡∏µ</p>
          <p><strong>‡∏Ç‡πâ‡∏≠‡∏î‡∏µ‡∏Ç‡∏≠‡∏á‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à:</strong> ${advantages[type]}</p>
        </div>
      `;
    }
  </script>
</body>
</html>
